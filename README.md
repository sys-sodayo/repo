你在 README 里的公式之所以显示不出来，是因为 GitHub 的 Markdown 只对行内公式（`$...$`）和块级公式（`$$...$$`）有比较好的支持，而你用的是 `\\[ ... \\]` 这种 LaTeX 环境写法。
**解决办法**就是统一改成 GitHub Markdown 支持的语法。

我帮你把文档里的公式都换成了 **`$...$`（行内）** 和 **`$$...$$`（块级）**，这样放到 README 里就能正常渲染了：

---

# DANN (领域对抗神经网络) 原理详解

### 核心思想：左右互搏，修成正果

DANN的核心思想源于一个非常直观的博弈论概念：**如果你想让两个人无法分辨出某样东西的区别，那就训练其中一个人（特征提取器）去“欺骗”另一个人（领域判别器），直到判别器彻底混淆为止。**

在我们的任务中：

* **源域 (Source Domain)**：实验室环境下的CWRU轴承数据。数据量大，有精确的故障标签。
* **目标域 (Target Domain)**：真实线路环境下的轴承数据。数据无标签，但与源域数据存在一定的分布差异（例如，由不同的运行工况、噪声环境等引起）。
* **目标**: 训练一个模型，它在源域上学到的故障分类能力，可以很好地应用（迁移）到目标域上。

---

### DANN的三个核心组件与公式

我们将整个网络模型拆解为三个部分：特征提取器 \$G\_f\$、标签分类器 \$G\_y\$、和领域分类器 \$G\_d\$。

---

#### 1. 特征提取器 (Feature Extractor, \$G\_f\$)

* **功能**: 将输入数据 \$x\$ 映射到高维特征空间，生成特征向量 \$f\$。
* **公式**:

$f_i = G_f(x_i; \theta_f)$

其中，\$x\_i\$ 是第 \$i\$ 个输入样本，\$\theta\_f\$ 是特征提取器参数。

---

#### 2. 标签分类器 (Label Classifier, \$G\_y\$)

* **公式**:

$y_i = G_y(f_i; \theta_y)$

* **损失函数 (标签分类损失 \$L\_y\$)**：

$L_y(\theta_f, \theta_y) = \sum_{x_i \in \text{Source}} L_{ce}(G_y(G_f(x_i)), y_i)$

其中 \$L\_{ce}\$ 是交叉熵损失函数。

---

#### 3. 领域分类器 (Domain Classifier, \$G\_d\$)

* **公式**:

$d_i = G_d(f_i; \theta_d)$

* **损失函数 (领域分类损失 \$L\_d\$)**：

$L_d(\theta_f, \theta_d) = \sum_{x_i \in \text{Source} \cup \text{Target}} L_{ce}(G_d(G_f(x_i)), d_i)$

---

### 对抗的实现：梯度反转层 (GRL)

* **前向传播**：

$R_\lambda(f) = f$

* **反向传播**：

$\frac{dR_\lambda}{df} = -\lambda I$

---

### 最终的优化目标

$$
E(\theta_f, \theta_y, \theta_d) =
\sum_{x_i \in \text{Source}} L_y(G_y(G_f(x_i)), y_i)
- \lambda \sum_{x_i \in \text{Source} \cup \text{Target}} L_d(G_d(G_f(x_i)), d_i)
$$

---
